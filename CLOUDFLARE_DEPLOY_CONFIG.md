# Cloudflare Pages éƒ¨ç½²é…ç½®æŒ‡å—

## ğŸ“‹ åœ¨ Cloudflare Pages æ§åˆ¶å°ä¸­çš„é…ç½®

### 1. åŸºæœ¬æ„å»ºè®¾ç½®

åœ¨ Cloudflare Pages é¡¹ç›®è®¾ç½®ä¸­ï¼Œé…ç½®ä»¥ä¸‹å†…å®¹ï¼š

#### Framework presetï¼ˆæ¡†æ¶é¢„è®¾ï¼‰
é€‰æ‹©ï¼š**Next.js**

#### Build commandï¼ˆæ„å»ºå‘½ä»¤ï¼‰
```
npm run build
```

#### Build output directoryï¼ˆæ„å»ºè¾“å‡ºç›®å½•ï¼‰
```
.next
```

#### Root directoryï¼ˆæ ¹ç›®å½•ï¼‰
```
/ï¼ˆç•™ç©ºæˆ–å¡«å†™é¡¹ç›®æ ¹ç›®å½•ï¼‰
```

#### Node.js versionï¼ˆNode.js ç‰ˆæœ¬ï¼‰
```
18
```
æˆ–é€‰æ‹© `20`ã€`22`ï¼ˆæ¨èä½¿ç”¨ 18 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰

---

## ğŸ”§ è¯¦ç»†é…ç½®æ­¥éª¤

### æ­¥éª¤ 1: è¿›å…¥ Cloudflare Pages æ§åˆ¶å°

1. è®¿é—® [Cloudflare Dashboard](https://dash.cloudflare.com/)
2. ç‚¹å‡»å·¦ä¾§èœå•çš„ **"Pages"**
3. ç‚¹å‡» **"Create a project"** æˆ–é€‰æ‹©ç°æœ‰é¡¹ç›®

### æ­¥éª¤ 2: è¿æ¥ Git ä»“åº“

1. é€‰æ‹© **"Connect to Git"**
2. é€‰æ‹©æ‚¨çš„ Git æä¾›å•†ï¼ˆGitHubã€GitLabã€Bitbucketï¼‰
3. æˆæƒ Cloudflare è®¿é—®æ‚¨çš„ä»“åº“
4. é€‰æ‹©è¦éƒ¨ç½²çš„ä»“åº“

### æ­¥éª¤ 3: é…ç½®æ„å»ºè®¾ç½®

åœ¨ **"Configure build"** é¡µé¢ä¸­ï¼š

#### Build settingsï¼ˆæ„å»ºè®¾ç½®ï¼‰

```
Framework preset: Next.js
Build command: npm run build
Build output directory: .next
Root directory: /ï¼ˆç•™ç©ºï¼‰
```

#### Environment variablesï¼ˆç¯å¢ƒå˜é‡ï¼‰

ç‚¹å‡» **"Add variable"** æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

| å˜é‡å | å€¼ | è¯´æ˜ |
|--------|-----|------|
| `SESSION_SECRET` | éšæœºå­—ç¬¦ä¸²ï¼ˆè‡³å°‘32å­—ç¬¦ï¼‰ | ç”¨äºç®¡ç†å‘˜ç™»å½•ä¼šè¯åŠ å¯† |
| `NEXT_PUBLIC_BASE_URL` | `https://your-site.pages.dev` | æ‚¨çš„ç½‘ç«™ URLï¼ˆéƒ¨ç½²åä¼šè‡ªåŠ¨ç”Ÿæˆï¼‰ |
| `R2_PUBLIC_URL` | ï¼ˆå¯é€‰ï¼‰R2 å…¬å…±è®¿é—® URL | å¦‚æœé…ç½®äº† R2 è‡ªå®šä¹‰åŸŸå |

**ç”Ÿæˆ SESSION_SECRET çš„æ–¹æ³•ï¼š**
```bash
openssl rand -base64 32
```

### æ­¥éª¤ 4: ä¿å­˜å¹¶éƒ¨ç½²

1. ç‚¹å‡» **"Save and Deploy"**
2. Cloudflare ä¼šè‡ªåŠ¨å¼€å§‹æ„å»ºå’Œéƒ¨ç½²

---

## ğŸ“ å®Œæ•´é…ç½®ç¤ºä¾‹

### æ„å»ºè®¾ç½®æˆªå›¾è¯´æ˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Framework preset                    â”‚
â”‚ [Next.js â–¼]                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Build command                       â”‚
â”‚ [npm run build]                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Build output directory              â”‚
â”‚ [.next]                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Root directory                      â”‚
â”‚ [/]                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Node.js version                     â”‚
â”‚ [18 â–¼]                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç¯å¢ƒå˜é‡é…ç½®ç¤ºä¾‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Environment variables                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SESSION_SECRET                      â”‚
â”‚ [your-secret-key-here...]           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ NEXT_PUBLIC_BASE_URL                â”‚
â”‚ [https://your-site.pages.dev]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš™ï¸ é«˜çº§é…ç½®ï¼ˆå¯é€‰ï¼‰

### è‡ªå®šä¹‰æ„å»ºå‘½ä»¤

å¦‚æœéœ€è¦å®‰è£…é¢å¤–çš„ä¾èµ–æˆ–è¿è¡Œè¿ç§»ï¼š

```
npm ci && npm run build
```

### ä½¿ç”¨ Wrangler é…ç½®

å¦‚æœæ‚¨ä½¿ç”¨ `wrangler.toml` æ–‡ä»¶ï¼Œç¡®ä¿ï¼š

1. æ–‡ä»¶åœ¨é¡¹ç›®æ ¹ç›®å½•
2. å·²æ­£ç¡®é…ç½® D1 æ•°æ®åº“ ID
3. å·²é…ç½® R2 å­˜å‚¨æ¡¶ç»‘å®š

---

## ğŸ” éªŒè¯éƒ¨ç½²

éƒ¨ç½²æˆåŠŸåï¼Œæ£€æŸ¥ï¼š

1. **æ„å»ºæ—¥å¿—**ï¼šæŸ¥çœ‹æ˜¯å¦æœ‰é”™è¯¯
2. **ç½‘ç«™è®¿é—®**ï¼šè®¿é—®ç”Ÿæˆçš„ `.pages.dev` åŸŸå
3. **API è·¯ç”±**ï¼šæµ‹è¯• `/api/products` ç­‰è·¯ç”±
4. **ç®¡ç†å‘˜ç™»å½•**ï¼šè®¿é—® `/admin/login`

---

## âš ï¸ å¸¸è§é—®é¢˜

### é—®é¢˜ 1: æ„å»ºå¤±è´¥

**é”™è¯¯**ï¼š`Build failed`

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥ Node.js ç‰ˆæœ¬ï¼ˆéœ€è¦ 18+ï¼‰
- æŸ¥çœ‹æ„å»ºæ—¥å¿—ä¸­çš„å…·ä½“é”™è¯¯
- ç¡®ä¿æ‰€æœ‰ä¾èµ–éƒ½å·²æ­£ç¡®å®‰è£…

### é—®é¢˜ 2: ç¯å¢ƒå˜é‡æœªç”Ÿæ•ˆ

**é”™è¯¯**ï¼šç¯å¢ƒå˜é‡åœ¨è¿è¡Œæ—¶æœªæ‰¾åˆ°

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç¡®ä¿ç¯å¢ƒå˜é‡åç§°æ­£ç¡®
- æ³¨æ„ `NEXT_PUBLIC_` å‰ç¼€ï¼ˆç”¨äºå®¢æˆ·ç«¯å˜é‡ï¼‰
- é‡æ–°éƒ¨ç½²ä»¥åº”ç”¨æ–°çš„ç¯å¢ƒå˜é‡

### é—®é¢˜ 3: æ•°æ®åº“è¿æ¥å¤±è´¥

**é”™è¯¯**ï¼šD1 æ•°æ®åº“è¿æ¥é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥ `wrangler.toml` ä¸­çš„ `database_id`
- ç¡®ä¿ D1 æ•°æ®åº“å·²åˆ›å»º
- æ£€æŸ¥æ•°æ®åº“ç»‘å®šåç§°æ˜¯å¦æ­£ç¡®

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Cloudflare Pages æ–‡æ¡£](https://developers.cloudflare.com/pages/)
- [Next.js on Cloudflare Pages](https://developers.cloudflare.com/pages/framework-guides/nextjs/)
- [ç¯å¢ƒå˜é‡é…ç½®](https://developers.cloudflare.com/pages/platform/build-configuration/#environment-variables)

---

## âœ… å¿«é€Ÿæ£€æŸ¥æ¸…å•

- [ ] Framework preset è®¾ç½®ä¸º `Next.js`
- [ ] Build command è®¾ç½®ä¸º `npm run build`
- [ ] Build output directory è®¾ç½®ä¸º `.next`
- [ ] Node.js version è®¾ç½®ä¸º `18` æˆ–æ›´é«˜
- [ ] `SESSION_SECRET` ç¯å¢ƒå˜é‡å·²è®¾ç½®
- [ ] `NEXT_PUBLIC_BASE_URL` ç¯å¢ƒå˜é‡å·²è®¾ç½®ï¼ˆå¯é€‰ï¼Œéƒ¨ç½²åä¼šè‡ªåŠ¨ç”Ÿæˆï¼‰
- [ ] Git ä»“åº“å·²è¿æ¥
- [ ] ä»£ç å·²æ¨é€åˆ° Git

**å®Œæˆä»¥ä¸Šé…ç½®åï¼Œç‚¹å‡» "Save and Deploy" å³å¯å¼€å§‹éƒ¨ç½²ï¼**

